Тестовое задание (Backend)
Тестовое задание на позицию "Backend-разработчик"
1. Краткое описание задачи
Необходимо реализовать бэкенд-сервис, который взаимодействует с контрактом стандарта ERC-721 в блокчейне Ethereum.
Суть разрабатываемого сервиса заключается в том, чтобы производить операции с NFT-токеном, используя REST API. В таком сервисе должна быть одна операция на получение информации из блокчейна и ее выдачу в API-ответе, и одна операция, результат которой будет изменять состояние смарт-контракта.
Говоря простыми словами, целью задачи является интеграция с NFT токеном, и написание сервиса по взаимодействию с ним.
1.1. Что такое NFT-токен?
NFT-токен - это неделимый цифровой актив в блокчейн-сети. В общем понимании, такой токен - это объект с определенным набором параметров, и при этом, все единицы такого обьекта - являются уникальными между собой.
В техническом понимании, такой токен представлен в виде смарт-контракта в блокчейн сети - т.е. некоторого модуля, имеющего функции на чтение и запись.
1.2. Основные условия к выполнению задачи
Оценка времени реализации: 3-4 часа без учета времени на ознакомление с документацией
Полное выполнение всей задачи - не является обязательным критерием оценки реализации. В первую очередь будет анализироваться общий подход к выполнению задачи, пониманию требований, и корректность реализации алгоритмов и внутренней логики.
Для реализации данной задачи будет важнее составить общий прототип за выделенное время, чем сделать всего одну, но максимально отлаженную функцию.
Выполненное задание необходимо разместить в Git-репозитории с публичным доступом, и желательно чтобы процесс разработки был отражен в коммитах.

2. Стек реализации:
•	Язык: Python 3.7+
•	Web framework: Django 4+ & DRF
•	Database: SQLite / PostgreSQL
•	Blockchain framework: Web3.py
•	Blockchain: Ethereum (Goerli Testnet)
Опциональные требования:
•	Произвести контейнеризацию сервиса в Docker - написать базовый Dockerfile и описать конфигурацию в Docker Compose для запуска самого сервиса и базы данных.
•	Подключить Swagger (например через расширения drf-yasg, spectacular) и сделать нотацию для всех view.

3. Что должно быть реализовано
3.1. Модели БД:
1.	Модель Token должна содержать поля:
•	id - primary key
•	unique_hash - уникальный хэш
•	tx_hash - хэш транзакции создания токена
•	media_url - урл с произвольным изображением
•	owner - адрес пользователя в сети Ethereum
3.2. Представления API (Views):
1.	/tokens/create
Метод запроса: POST
Это API должно создавать новый уникальный токен в блокчейне и записывать параметры запроса в БД.

Запрос должен принимать:
- media_url - урл с произвольным изображением
- owner - Ethereum-адрес будущего владельца токена

В ответе успешно выполненного запроса должна передаваться репрезентация обьекта Token
2.	/tokens/list
Метод запроса: GET
Это API должно выдавать список всех обьектов модели Token
3.	/tokens/total_supply
Метод запроса: GET
Это API должно обращаться к контракту в блокчейне и выдавать в ответе информацию о текущем Total supply токена - общем числе находящихся токенов в сети. Форма ответа - произвольная, в JSON-формате. Минимальный базовый пример ответа - {"result": 10000}
3.3. Конфигурирование сервиса
•	Все настраиваемые параметры сервиса - должны устанавливаться либо через .env файл, либо при помощи конфигурационного файла в формате YAML. Туда же необходимо поместить параметры, содержащие приватную информацию (адрес, приватный ключ адреса, api-ключи используемых сервисов)

4. Как должно быть реализовано
4.1. Создание токена
При вызове API-точки /tokens/create, последовательно происходит следующая логика:

1. Создается новый обьект модели Token, в который сохраняются данные из параметра запроса, помимо этого генерируется любая рандомная строка*, которая также сохраняется в созданный обьект. Объект сохраняется.
Любая рандомная строка - должна состоять из букв и цифр (т.е. без спецсимволов) и иметь длину в 20 знаков.

2. На основе сохраненного обьекта, производится state-changing обращение к контракту токена.
Для этого, при помощи фреймворка Web3 необходимо будет совершить следующее:
•	Создать вызов к функции mint у смарт-контракта. Аргументами функции смарт-контракта будут сопоставимые аргументы модели Token. Информация по взаимодействию с методом смарт-контракта - в следующем разделе.
•	Подписать приватным ключом транзакцию с вызовом функции.
•	Отправить подписанную транзакцию в сеть. При отправке транзакции, библиотека Web3 выдаст transaction hash - идентификатор транзакции. Его нужно сохранить в поле tx_hash у созданного обьекта модели Token.
4.2. Получение информации о общем числе токенов (total supply)
При вызове API-точки /tokens/total_supply, необходимо произвести вызов функции totalSupply на чтение информации из смарт-контракта, получить ответ из блокчейна и выдать эту информацию в ответ API-запроса

4.3. Отображение списка токенов
При вызове API-точки /tokens/list необходимо передать в ответ список всех объектов модели Token. Опционально - добавить пагинацию данного списка, с page size = 200 и max page size = 500

5. Рекомендации по работе с блокчейном
5.1. Основная информация
Для взаимодействия со смарт-контрактом токена в блокчейне, нужно использовать библиотеку Web3.py. Документация по библиотеке: https://web3py.readthedocs.io/en/stable/
Для выполнения задачи нужно будет реализовать подключение к провайдеру Web3, и написать вызовы функций контракта и обработку выполнения этих вызовов.
Блокчейн-провайдер - это сервис, через который необходимо будет подключить фреймворк Web3.
Информацию по подключению провайдера можно найти здесь:
https://web3py.readthedocs.io/en/stable/examples.html#using-infura-goerli-node
В качестве такого провайдера рекомендуется использовать Infura или Moralis:
https://infura.io/
https://docs.moralis.io/speedy-nodes/connecting-to-rpc-nodes/connect-to-eth-node

5.2. Смарт-контракт NFT-токена для интеграции
Cеть: Ethereum Goerli Testnet
Блокчейн-эксплорер сети: https://goerli.etherscan.io/
Страница смарт-контракта: https://goerli.etherscan.io/address/0xcfcb050e965115a8f7922d617a39ea577bcac2c1

На странице контракта есть его адрес (указан вверху - Contract 0x....) его нужно будет использовать для обращений к контракту, при инициализации инстанса контракта в коде.
Помимо этого, на странице контракта есть вкладка Contract, и на ней вкладки - Code, Read Contract, Write Contract.
•	На вкладке Code, внизу страницы - есть пункт Contract ABI - его также нужно будет использовать для обращений к контракту, при его инициализации инстанса контракта в коде.
•	На вкладке Read Contract - перечислены методы на чтение. Среди перечисленных функций можно будет увидеть метод totalSupply, который необходимо использовать в API /tokens/total_supply
•	На вкладке Write Contract - перечислены методы на запись. Среди перечисленных функций можно будет увидеть метод mint и его аргументы. Этот метод необходимо использовать в API /tokens/create

5.3. Взаимодействие с функциями контракта
•	Вызов функции на чтение - является обращением, которое не изменяет состояние сети, поэтому не требует отправки транзакции, и по своей сути очень похоже на обращение в привычные API. Пример вызова такой функции:
https://web3py.readthedocs.io/en/stable/contracts.html#web3.contract.ContractFunction
•	Вызов функции на запись - требует подписывания транзакции и отправки ее в сеть. Пример как составляется вызов функции контракта можно найти здесь:
https://web3py.readthedocs.io/en/stable/web3.eth.account.html#sign-a-contract-transaction

5.4. Подпись транзакций и их отправка в блокчейн
Для того, чтобы отправлять транзакции, необходимо иметь адрес в сети Ethereum, ненулевой баланс на адресе, а также иметь доступ к блокчейн-провайдеру:
•	Для того, чтобы сделать себе такой адрес, необходимо установить расширение для браузера Metamask и создать там аккаунт. У созданного аккаунта в Metamask можно получить его приватный ключ (находится во вкладке "Account details"). Этот приватный ключ необходимо будет использовать в сервисе для получения доступа к созданному адресу.
•	Транзакции необходимо будет отправлять в тестовую сеть Goerli, блокчейна Ethereum. В тестовой сети можно получить на свой адрес бесплатных средств для проведения транзакций на фаусетах:
o	https://goerlifaucet.com/
o	https://goerli-faucet.pk910.de/
o	https://goerlifaucet.org/
o	https://faucetlink.to/goerli
